<!DOCTYPE html>
<html layout:decorator="layout">
    <head>
    </head>

    <body>
        <span layout:fragment="title">Accounts</span>
        <div layout:fragment="content" class="results">
            <div class="row">
                <div class="collapse in" id="openAccounts">
                    <table class="table table-striped table_accordion">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Enabled</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="row,rowStat : ${allAccounts}" th:class="${row.id == account.id ? 'info' : ''}">
                                <td th:text="${row.username}">Hi I am the first account ever</td>
                                <td th:text="${row.email}">-</td>
                                <td th:text="${row.role}">-</td>
                                <td th:text="${row.enabled}">-</td>
                                <td>
                                    <a class="btn btn-edit btn-sm btn-default" th:href="@{/accounts/edit/__${row.id}__}">Edit</a>
                                    <a class="btn btn-sm btn-disable-account" th:classappend="${row.enabled == true} ? btn-danger : btn-success"
                                            th:href="@{/accounts/state/__${row.id}__/__${!row.enabled}__}" th:text="${row.enabled == true ? 'Disable':'Enable'}">Disable</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <h3>Create Account</h3>

            <div class="row">
                <form data-toggle="validator" th:action="@{/accounts/createUpdate}" th:object="${account}" method="post" >
                    <div class="border-gray">
                        <input type="hidden"  th:field="${account.id}"/>
                        <div class="form-group">
                            <label class="control-label" for="username">Username</label><br />
                            <input id="username" class="form-control" type="text" th:required="required" data-minlength="6" th:field="${account.username}"/>
                            <div class="help-block with-errors"></div>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="email">Email</label><br />
                            <input id="email" class="form-control" type="text" th:required="required" th:field="${account.email}"/>
                            <div class="help-block with-errors"></div>
                        </div>

                        <div class="form-group" th:if="${account?.id == null and account?.password == null}">
                            <label class="control-label" for="password">Password</label><br />
                            <input id="password" class="form-control" type="text" th:required="required" data-minlength="6" th:field="${account.password}"/>
                            <div class="help-block with-errors"></div>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="userRole">Role</label><br />
                            <select id="userRole" th:field="${account.role}">
                                <option th:each="role : ${T(bg.sofia.tu.enums.Role).values()}"
                                        th:value="${role.getValue()}"
                                        th:text="${role}">
                                </option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="enabled">Enabled</label><br />
                            <input id="enabled" type="checkbox" th:field="${account.enabled}" />
                        </div>

                    </div>
                    <br />
                    <!--<button class="btn btn-lg btn-primary">Save</button>-->
                    <button class="btn btn-primary btn-lg" id="createAccount" th:text="${account.id != null ? 'Update':'Create'}">Create</button>
                </form>
            </div>
        </div>
    </body>
</html>